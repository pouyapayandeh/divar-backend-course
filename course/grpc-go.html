<!DOCTYPE html>
<html lang="fa-IR">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>مایکروسرویس gRPC با Go | دوره آموزشی back-end دیوار</title>
    <meta name="description" content="">
    <link rel="icon" href="/divar-backend-course/favicon.png">
    
    <link rel="preload" href="/divar-backend-course/assets/css/0.styles.fca2b89e.css" as="style"><link rel="preload" href="/divar-backend-course/assets/js/app.5df85f72.js" as="script"><link rel="preload" href="/divar-backend-course/assets/js/2.15bccd6b.js" as="script"><link rel="preload" href="/divar-backend-course/assets/js/11.f6878dff.js" as="script"><link rel="prefetch" href="/divar-backend-course/assets/js/10.0b553bf3.js"><link rel="prefetch" href="/divar-backend-course/assets/js/12.bb411c5b.js"><link rel="prefetch" href="/divar-backend-course/assets/js/13.1bbf0aa3.js"><link rel="prefetch" href="/divar-backend-course/assets/js/14.631bdd7a.js"><link rel="prefetch" href="/divar-backend-course/assets/js/15.ee5e7602.js"><link rel="prefetch" href="/divar-backend-course/assets/js/16.5e068667.js"><link rel="prefetch" href="/divar-backend-course/assets/js/17.ebb2ee22.js"><link rel="prefetch" href="/divar-backend-course/assets/js/18.e84e5535.js"><link rel="prefetch" href="/divar-backend-course/assets/js/19.9019b592.js"><link rel="prefetch" href="/divar-backend-course/assets/js/20.5c88cb6e.js"><link rel="prefetch" href="/divar-backend-course/assets/js/21.6c44b5c6.js"><link rel="prefetch" href="/divar-backend-course/assets/js/3.7af8c2e2.js"><link rel="prefetch" href="/divar-backend-course/assets/js/4.813a2721.js"><link rel="prefetch" href="/divar-backend-course/assets/js/5.adc36d38.js"><link rel="prefetch" href="/divar-backend-course/assets/js/6.48238d53.js"><link rel="prefetch" href="/divar-backend-course/assets/js/7.50dd109a.js"><link rel="prefetch" href="/divar-backend-course/assets/js/8.fc4ebc1c.js"><link rel="prefetch" href="/divar-backend-course/assets/js/9.93103164.js">
    <link rel="stylesheet" href="/divar-backend-course/assets/css/0.styles.fca2b89e.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/divar-backend-course/" class="home-link router-link-active"><img src="/divar-backend-course/logo.png" alt="دوره آموزشی back-end دیوار" class="logo"> <span class="site-name can-hide">دوره آموزشی back-end دیوار</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://careers.divar.ir/positions#department=Engineering" target="_blank" rel="noopener noreferrer" class="nav-link external">
  فرصت‌های شغلی
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://divar.ir/about" target="_blank" rel="noopener noreferrer" class="nav-link external">
  دربارهٔ دیوار
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://github.com/pouyapayandeh/divar-backend-course" target="_blank" rel="noopener noreferrer" class="repo-link">
    github
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://careers.divar.ir/positions#department=Engineering" target="_blank" rel="noopener noreferrer" class="nav-link external">
  فرصت‌های شغلی
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://divar.ir/about" target="_blank" rel="noopener noreferrer" class="nav-link external">
  دربارهٔ دیوار
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://github.com/pouyapayandeh/divar-backend-course" target="_blank" rel="noopener noreferrer" class="repo-link">
    github
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><a href="/divar-backend-course/course/intro.html" class="sidebar-link">به دیوار خوش اومدی!</a></li><li><a href="/divar-backend-course/course/bash.html" class="sidebar-link">آشنایی با Bash Script</a></li><li><a href="/divar-backend-course/course/python-intro.html" class="sidebar-link">آشنایی با پایتون</a></li><li><a href="/divar-backend-course/course/network-intro.html" class="sidebar-link">آشنایی با شبکه</a></li><li><a href="/divar-backend-course/course/vc.html" class="sidebar-link">کنترل نسخه</a></li><li><a href="/divar-backend-course/course/proje1.html" class="sidebar-link">پروژه Ubuntu Paste</a></li><li><a href="/divar-backend-course/course/db.html" class="sidebar-link">دیتابیس</a></li><li><a href="/divar-backend-course/course/backup.html" class="sidebar-link">بکاپ گیری</a></li><li><a href="/divar-backend-course/course/rest.html" class="sidebar-link">سرویس های Restful</a></li><li><a href="/divar-backend-course/course/proje-drf.html" class="sidebar-link">پروژه DRF</a></li><li><a href="/divar-backend-course/course/go-intro.html" class="sidebar-link">آشنایی با زبان Go</a></li><li><a href="/divar-backend-course/course/grpc-go.html" class="active sidebar-link">مایکروسرویس gRPC با Go</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/divar-backend-course/course/grpc-go.html#تست" class="sidebar-link">تست</a></li></ul></li><li><a href="/divar-backend-course/course/docker-intro.html" class="sidebar-link">آشنایی با Docker</a></li><li><a href="/divar-backend-course/course/kube.html" class="sidebar-link">کوبرنتیز</a></li><li><a href="/divar-backend-course/course/owasp.html" class="sidebar-link">آشنایی با OWASP</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="مایکروسرویس-grpc-با-go"><a href="#مایکروسرویس-grpc-با-go" class="header-anchor">#</a> مایکروسرویس gRPC با Go</h1> <h3 id=""><a href="#" class="header-anchor">#</a> \</h3> <p>اهداف</p> <ul><li>آشنایی با Best Practice ها و معماری‌های سرویس‌ها با زبان Go</li> <li>آشنایی با پروتکل gRPC</li> <li>آشنایی با فرآیند Lock در Go</li> <li>نصب پکیج (go modules)</li> <li>آشنایی با Best Practice نوشتن Command Line Interface</li> <li>آشنایی با Dependency Injection</li> <li>آشنایی با testing در Go</li></ul> <p>اگه همهٔ امکانات و قابلیت‌های یک محصول تو قالب یک پروژه باشه، اون پروژه بعد از مدتی میتونه خیلی گنده و غیر قابل کنترل باشه. یه معماری که اخیرا شرکت‌های مختلفی تو جهان (از جمله خود کافه‌بازار و دیوار) دارن به سمتش میرن Microservice نام داره. با توجه به اینکه این کلمه رو احتمالا زیاد خواهی شنید، خوبه که <a href="https://www.nginx.com/blog/introduction-to-microservices/" target="_blank" rel="noopener noreferrer">این لینک<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> رو یه مطالعه‌ای بکنی .(شاید کامل همهٔ بخش‌هاش رو متوجه نشی، ولی با سرچ کلماتی که باهاش آشنا نیستی تهش می‌تونی یه دید کلی‌ای نسبت به اینکه اصلا این معماری چی هست در بیاری)</p> <p>پایتون زبان خیلی راحتیه و باهاش پروژه سریع جلو میره ولی وقتی پای همروندی توی مقیاس زیاد مطرح می‌شه خیلی قوی ظاهر نمی‌شه. ما توی شرکت وقتی ترافیک یک API خیلی زیاد باشه معمولا اون رو به صورت یک مایکروسرویس با زبون Go می‌نویسیم. در این مرحله می‌خواهیم یک سرویس برای یادگیری Go بنویسیم.</p> <h3 id="برای-مطالعه"><a href="#برای-مطالعه" class="header-anchor">#</a> برای مطالعه</h3> <ul><li>برای آشنا شدن با ساختار های مرسوم پروژه در زبان Go بد نیست به <a href="https://github.com/golang-standards/project-layout" target="_blank" rel="noopener noreferrer">این پروژه<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> یه نگاهی بندازی.</li> <li><a href="https://github.com/cafebazaar/go-boilerplate" target="_blank" rel="noopener noreferrer">این یکی پروژه<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> رو بچه‌های شرکت نوشتن. یه سمپل مایکروسرویس با Goعه که با نیاز های شرکت همخونی داره. بد نیست به این هم یه نگاهی بندازی.</li> <li><a href="https://git.cafebazaar.ir/bardia/go-microservice-sample" target="_blank" rel="noopener noreferrer">این پروژه<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> هم مشابه قبلیه ولی برای <strong>دوره آموزشی</strong> ساده سازی شده. این یکی رو حتما کامل بخون. برای اینکه توی Go پروژه‌ای بنویسیم که بشه براش راحت تست نوشت لازمه که الگوی Dependency Injection رو رعایت کنیم. برای آشنا شدن با این الگو <a href="https://www.martinfowler.com/articles/injection.html" target="_blank" rel="noopener noreferrer">این مقاله<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> رو بخونید و توی سمپلی که داده شده به جاهایی که از این الگو استفاده شده دقت کنید.</li> <li>پروتکل gRPC یه پروتکل جدیده که گوگل نوشتش و برای ارتباط بین مایکروسرویس‌ها خیلی مناسبه. برای یادگیری این پروتکل این <a href="https://grpc.io/docs/quickstart/go/" target="_blank" rel="noopener noreferrer">لینک<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> و این <a href="https://grpc.io/docs/tutorials/basic/go/" target="_blank" rel="noopener noreferrer">لینک<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> رو بخون.</li></ul> <h3 id="تمرین"><a href="#تمرین" class="header-anchor">#</a> تمرین</h3> <ul><li><p>فرض کن توی کافه‌‌بازار یک API داریم که با گرفتن اسم یه package name اطلاعات اون رو بر میگردونه و با Python نوشته شده. ولی این API یکم کنده و نمیتونه بار زیادی رو تحمل کنه. ما می‌خوایم یک سرویس با Go بنویسیم که نقش cache رو داشته باشه. یعنی ریکوئست کاربر به جای اینکه مستقیم API رو صدا بزنه به سرویس ما میاد. ما نگاه می‌کنیم اگه اطلاعات توی حافظه ما بود جواب رو به کاربر بر می‌گردونیم و اگه نبود اطلاعات رو از API می‌گیریم توی cache خودمون ذخیره می‌کنیم و بعد جواب رو به کاربر می‌دیم.</p> <p>APIی که راجع بش صحبت کردیم با پرتکل gRPC نوشته شده و روی  <code>appdetail.test.roo.cloud</code> و پورت <code>8080</code> قابل دسترسیه. فایل protobuf ش رو از <a href="https://drive.google.com/open?id=1lxXZjhooz8bAKlwXSjnAHo4KxkzNqt02" target="_blank" rel="noopener noreferrer">این لینک<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> می‌تونی بگیری.</p> <p>با توجه به سمپل کد داده شده یک سرویس gRPC با گو بنویس که  اینکارو انجام بده. برای نوشتن این پروژه از Go ورژن بزرگ تر از ۱.۱۱ (ترجیحا ورژن آخر) استفاده کن. برای نصب پکیج‌ها هم از go modules استفاده کن که از ورژن ۱۱ به بعد اضافه شده. برای cache کردن هم می‌تونی از  پکیج <a href="https://github.com/allegro/bigcache" target="_blank" rel="noopener noreferrer">bigcache<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> استفاده کنی.</p></li> <li><p>برای پروژت یک cli بنویس که دو دستور run برای اجرای سرور و version برای چاپ کردن نام و ورژن فعلی پروژه داشته باشه. برای نوشتن cli میتونی از کتابخانه <a href="https://github.com/spf13/cobra" target="_blank" rel="noopener noreferrer">Cobra<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> استفاده کنی.</p></li> <li><p>حالا می‌خوایم یکم سرویسمون رو هوشمندترش کنیم که توی ترافیک بالا بهتر پاسخگو باشه. فرض کنیم ما اپلیکیشن A رو توی حافظه cache سرویسمون نداریم. وقتی کاربر درخواست اطلاعات اپلیکیشن A رو میده سرویسمون میره از API اطلاعات سرویس A رو بگیره ولی قبل اینکه API جواب بده ۱۰ کاربر دیگه دوباره درخواست اطلاعات اپلیکیشن A رو می‌کنن اینطوری سرویس ما چون هنوز اطلاعات این اپلیکیشن رو نداره ۱۰ بار دیگه API رو فراخوانی می‌کنه و از اونجایی که API ما خیلی کند بود این اتفاق شاید باعث بوجود اومدن مشکل بشه. با استفاده از Mutex توی Go کاری کن که اگه ۱۰ نفر با هم خواستن اطلاعات یک اپ یکسان رو از API بگیرن یکیشون اینکارو بکنه و اون ۹ تای دیگه وایسن تا جواب اولی بیاد از جواب همون اولی استفاده کنن.</p></li></ul> <h2 id="تست"><a href="#تست" class="header-anchor">#</a> تست</h2> <p>کدی که تا الان نوشتیم پیچیدگی بیشتری نسبت به تمرین های قبل. حالا برای اینکه مطمئن بشیم کدهایی که زدیم همونطور که انتظار داریم کار می‌کنن و اگر بعدا یه جایی از کد رو تغییر دادیم بقیهٔ جاها خراب نشدن و چند دلیل ارزشمند دیگه برای کدمون تست می‌نویسیم.</p> <h3 id="برای-مطالعه-2"><a href="#برای-مطالعه-2" class="header-anchor">#</a> برای مطالعه</h3> <ul><li><a href="https://www.merixstudio.com/blog/test-automation-in-web-development/" target="_blank" rel="noopener noreferrer">این مقاله<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> خیلی خوبیه که مزیت های تست نوشتن رو می‌گه. خوبه که بخونیش</li> <li><a href="https://codeutopia.net/blog/2015/04/11/what-are-unit-testing-integration-testing-and-functional-testing/" target="_blank" rel="noopener noreferrer">این مقاله<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> هم انواع تست نوشتن رو توضیح میده</li> <li><a href="https://devopedia.org/mock-testing" target="_blank" rel="noopener noreferrer">این مقاله<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> هم mock کردن آبجکت ها برای تست نوشتن رو توضیح داده</li></ul> <h3 id="تمرین-2"><a href="#تمرین-2" class="header-anchor">#</a> تمرین</h3> <ul><li><p>برای این مایکرو سرویسی که نوشتیم unittest بنویس. برای اینکه این تست بتونه مستقلا اجرا بشه و بتونیم همه شرایط رو تست کنیم لازمه که بخشی که به سرویس پایتونی ریکوئست میزنه Mock شده باشه. برای اینکه اینکارو بنونید انجام بدی از قبل باید این بخش رو با الگوی Dependency Injection نوشته باشی.</p> <p>سعی کن توی تست همه حالت هایی که ممکنه اتفاق بیوفته رو پوشش بدی. اصلی ترین چیزی حتما باید با تست شبیه سازیش کنی حالتیه که یه اپلیکیشن توی cache نباشه و چندتا ریکوئست همزمان به صورت موازی برای گرفتنش درخواست بدن. توی این شرایط باید با Mock کردن کامپوننتی که ریکوئست میزنه بشماریم چند بار کال میشه</p></li></ul></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">آخرین بروزرسانی:</span> <span class="time">۱۴۰۰/۱/۲۴،‏ ۱۱:۰۶:۳۷</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/divar-backend-course/course/go-intro.html" class="prev">آشنایی با زبان Go</a></span> <span class="next"><a href="/divar-backend-course/course/docker-intro.html">آشنایی با Docker</a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/divar-backend-course/assets/js/app.5df85f72.js" defer></script><script src="/divar-backend-course/assets/js/2.15bccd6b.js" defer></script><script src="/divar-backend-course/assets/js/11.f6878dff.js" defer></script>
  </body>
</html>
